var Autocomplete = (function(){	var cities = ["Kiev","Dnepropetrovsk","Odessa","Kremenchug","Alushta","Chernigov","Yakutsk","Copenhagen","Oslo","Warsaw","Moscow","Malmo"];	var noOfItems = cities.length;		function open(invoker){		var container = invoker.siblings().eq(0);        //rerender dropdown after reopening(cleanup)		rerenderDropDown(container,noOfItems);		buildDropDown(container,invoker,noOfItems);		var nameHolder = $(invoker).children(0);				 $(invoker).next().children().each(function(){			 $(this).live('click',function(){					//$(nameHolder).text($(this).text());					$(invoker).text($(this).text());                    container.hide();					$('#requested-item').hide();					styleResetter();                    $(this).attr('class',$(this).attr('class') +' hovered');					$(nameHolder).show();           })		   })	};		var buildDropDown = function(container,invoker,noOfItems){		//var citiesDOMElements = new Array();		// if there are no sub-items yet		if (container.children().length == 0){				var inp = $('<input>');				inp.attr('id','requested-item');				inp.attr('class','item-name');				invoker.append(inp);			for (var i = 0 ;i < noOfItems; i++){				var item = $("<div class='dropped'>");				item.text(cities[i]);				container.append(item);				// array of sub-items elements				//citiesDOMElements[i] = item;		}		}	}		var rerenderDropDown = function(container,noOfItems){		for (var i = 0 ;i < noOfItems; i++){            if (container.children().length > 0){                container.show();            }        }	}		var init = function(locator) {		$(locator).click(function(){			open($(this));		})			//close on Esc		var drop = $('.items-drop-container');		$(document).live('keyup',function(event){			if (event.keyCode == 27) {					drop.hide();			}		})	};		var styleResetter = function(){		//document.getElementById('requested-item').style.display = 'none';        var itemsContainer = $('.items-drop-container');		$(itemsContainer).children().each(function(){			$(this).attr('class','dropped');		})    }        return {			init:init        } })(); 